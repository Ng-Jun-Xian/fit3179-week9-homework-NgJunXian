<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Global GDP Per Capita Map</title>
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #fafafa;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .container {
      max-width: 1000px;
      width: 100%;
      text-align: center;
    }
    h2 {
      color: #333;
      margin-bottom: 10px;
      font-size: 28px;
      font-weight: 600;
    }
    .subtitle {
      color: #666;
      font-size: 14px;
      margin-bottom: 20px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }
    #vis {
      margin: 20px auto;
      display: flex;
      justify-content: center;
    }
    .description {
      max-width: 900px;
      margin: 30px auto 0;
      padding: 25px;
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      text-align: left;
    }
  </style>
</head>
<body>

  <div class="container">
    <h1>How Coffee Affects the World?</h1>
    
    <div id="vis"></div>

<script type="text/javascript">
  const spec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "width": 800,
        "height": 500,
        "title": {
          "text": "GDP Per Capita by Country",
          "subtitle": "Gross Domestic Product per capita in current USD (2019) - Grey countries: No publicly available GDP data",
          "fontSize": 16,
          "anchor": "start",
          "color": "#333"
        },
        "projection": {"type": "equalEarth"},
        "layer": [
          {
            "data": {"sphere": true},
            "mark": {"type": "geoshape", "fill": "lightblue", "stroke": "steelblue", "strokeWidth": 1}
          },
          {
            "data": {"graticule": {"step": [30, 30]}},
            "mark": {"type": "geoshape", "fill": null, "stroke": "white", "strokeWidth": 0.3, "strokeOpacity": 0.5}
          },
          {
            "data": {
              "url": "ne_10m_admin_0_countries.json",
              "format": {"type": "topojson", "feature": "world_countries"}
            },
            "mark": {"type": "geoshape", "fill": "#ddd", "stroke": "white", "strokeWidth": 0.5}
          },
          {
            "data": {
              "url": "ne_10m_admin_0_countries.json",
              "format": {"type": "topojson", "feature": "world_countries"}
            },
            "transform": [
              {
                "lookup": "properties.NAME",
                "from": {
                  "data": {"url": "gdp_cleaned.csv"},
                  "key": "Country Name",
                  "fields": ["2019"]
                }
              },
              {"filter": "datum['2019'] != null"}
            ],
            "mark": {"type": "geoshape", "stroke": "white", "strokeWidth": 0.5},
            "encoding": {
              "color": {
                "field": "2019",
                "type": "quantitative",
                "scale": {
                  "scheme": "orangered",
                  "type": "log"
                },
                "legend": {"title": "GDP per capita (USD)"}
              },
              "tooltip": [
                {"field": "properties.NAME", "type": "nominal", "title": "Country"},
                {"field": "2019", "type": "quantitative", "title": "GDP per capita (USD)", "format": "$,.0f"}
              ]
            }
          }
        ]
      };

  vegaEmbed('#vis', spec);
</script>

</body>
</html>
